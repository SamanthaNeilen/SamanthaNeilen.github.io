<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Creating more maintainable JavaScript with self-executing functions</title>
    <meta name="description" content="I still mostly use regular JavaScript with jQuery in my applications. Before I started writing self-executing modules, my JavaScript was embedded all over th...">
    <link rel="stylesheet" href="/assets/css/syntax.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />
    <link rel="stylesheet" href="/assets/css/site.css" />
    <link rel="canonical" href="https://samanthaneilen.github.io/2019/12/30/Creating-more-maintainable-javascript-with-self-executing-functions.html">
    <link rel="alternate" type="application/rss+xml" title="Samantha Neilen" href="/feed.xml">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>
</head>

<body>
    <div class="container-fluid">
        <div class="row">
    <header aria-label="header" class="header">
        <span class="header-text">Samantha Neilen</span>
    </header>
</div>
        <div class="row">
            <div class="col-md-7 col-md-offset-1">
                <main class="page-content" aria-label="content">
                    <a href="/">Back to Home</a>
<article>
    <header class="article-header">
        Creating more maintainable JavaScript with self-executing functions
    </header>
    
    <span>Dec 30, 2019</span><br />
    Tags: 
                JavaScript 
			
    <div class="article-content">
        <p>I still mostly use regular JavaScript with jQuery in my applications. Before I started writing self-executing modules, my JavaScript was embedded all over the place in HTML and it was untestable (except for running a page in the browser).</p>

<p>A year or so ago a colleague introduced me to the concept of self-executing JavaScript functions. (Thank you Gijs Stoeldraaijers!) After adopting this practice, I found that I could write JavaScript modules with keeping the SOLID principles in mind. The most important benefits are creating smaller modules with a single purpose that can be tested and dependency injection support to make unit testing even easier. Even without adopting unit testing right away the improvements to maintainability were immense for me.</p>

<p>I’ll not go into JavaScript unit testing in this post and do an in-depth post as my next blog post. If you want to look into it, without waiting for that, please look at the <a href="https://docs.microsoft.com/en-us/visualstudio/javascript/unit-testing-javascript-with-visual-studio?view=vs-2019#unit-tests-in-other-project-types">Microsoft Docs page on Unit testing JavaScript and TypeScript in Visual Studio</a>.</p>

<p><strong>Table of contents:</strong></p>
<ul id="markdown-toc">
  <li><a href="#example-of-the-old-way-of-working-embedding-javascript-in-the-page" id="markdown-toc-example-of-the-old-way-of-working-embedding-javascript-in-the-page">Example of the old way of working (embedding JavaScript in the page)</a></li>
  <li><a href="#self-executing-functions" id="markdown-toc-self-executing-functions">Self-executing functions</a></li>
  <li><a href="#separating-html-control-events-and-javascript-hook-ups" id="markdown-toc-separating-html-control-events-and-javascript-hook-ups">Separating HTML control events and JavaScript hook-ups</a></li>
  <li><a href="#separating-html-templating-from-your-javascript-code" id="markdown-toc-separating-html-templating-from-your-javascript-code">Separating HTML templating from your JavaScript code</a></li>
</ul>

<h3 id="example-of-the-old-way-of-working-embedding-javascript-in-the-page">Example of the old way of working (embedding JavaScript in the page)</h3>
<p>Below, I have created an example of my old way of writing JavaScript on an overview page that loads data from an API endpoint and has some filter capabilities.</p>

<p>The data templates are hardcoded strings in the JavaScript and the search button event hookup is done through HTML markup.</p>

<p>A working Visual Studio project with the code listed below can be found in my <a href="https://github.com/SamanthaNeilen/JavascriptModulesExamples/tree/V1.0-Embedded-JavaScript">JavaScriptModuleExamples repository on GitHub with the tag “V1.0-Embedded-JavaScript”</a>.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@page
@model IndexModel
@{
    ViewData["Title"] = "Home page";
}
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;h1&gt;</span>Customer overview<span class="nt">&lt;/h1&gt;</span>

    @* Searchform *@
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"search-customer"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group row"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"searchCustomerName"</span> <span class="na">class=</span><span class="s">"col-sm-2 col-form-label"</span><span class="nt">&gt;</span>@Texts.Name<span class="nt">&lt;/label&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-sm-5"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">id=</span><span class="s">"searchCustomerName"</span> <span class="na">value=</span><span class="s">""</span><span class="nt">&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group row"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"searchEmail"</span> <span class="na">class=</span><span class="s">"col-sm-2 col-form-label"</span><span class="nt">&gt;</span>@Texts.Email<span class="nt">&lt;/label&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-sm-5"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">id=</span><span class="s">"searchEmail"</span> <span class="na">value=</span><span class="s">""</span><span class="nt">&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group row"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"searchCountry"</span> <span class="na">class=</span><span class="s">"col-sm-2 col-form-label"</span><span class="nt">&gt;</span>@Texts.Country<span class="nt">&lt;/label&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-sm-5"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">id=</span><span class="s">"searchCountry"</span> <span class="na">value=</span><span class="s">""</span><span class="nt">&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">class=</span><span class="s">"btn btn-sm btn-primary col-sm-2"</span> <span class="na">onclick=</span><span class="s">"filterData()"</span><span class="nt">&gt;</span>@Texts.Search<span class="nt">&lt;/button&gt;</span>
    <span class="nt">&lt;/div&gt;</span>

    @* Grid for data *@
    <span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">"table mt-2"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;thead&gt;</span>
            <span class="nt">&lt;tr&gt;</span>
                <span class="nt">&lt;th</span> <span class="na">scope=</span><span class="s">"col"</span><span class="nt">&gt;</span>@Texts.Name<span class="nt">&lt;/th&gt;</span>
                <span class="nt">&lt;th</span> <span class="na">scope=</span><span class="s">"col"</span><span class="nt">&gt;</span>@Texts.Email<span class="nt">&lt;/th&gt;</span>
                <span class="nt">&lt;th</span> <span class="na">scope=</span><span class="s">"col"</span><span class="nt">&gt;</span>@Texts.Country<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;/tr&gt;</span>
        <span class="nt">&lt;/thead&gt;</span>
        <span class="nt">&lt;tbody</span> <span class="na">id=</span><span class="s">"customer-table-body"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;tr</span> <span class="na">class=</span><span class="s">"loading-row"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;td</span> <span class="na">colspan=</span><span class="s">"3"</span><span class="nt">&gt;&lt;progress&gt;&lt;/progress&gt;&lt;/td&gt;</span>
            <span class="nt">&lt;/tr&gt;</span>
        <span class="nt">&lt;/tbody&gt;</span>
    <span class="nt">&lt;/table&gt;</span>
<span class="nt">&lt;/div&gt;</span>

@section Scripts {
    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
        <span class="kd">const</span> <span class="nx">CUSTOMER_ROW_SELECTOR</span> <span class="o">=</span> <span class="s1">'.customer-row'</span><span class="p">,</span>
            <span class="nx">LOADING_ROW_SELECTOR</span> <span class="o">=</span> <span class="s1">'.loading-row'</span><span class="p">,</span>
            <span class="nx">DISPLAY_NONE_CLASS</span> <span class="o">=</span> <span class="s1">'display-none'</span><span class="p">,</span>
            <span class="nx">CUSTOMER_TABLE_BODY</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'#customer-table-body'</span><span class="p">);</span>

        <span class="kd">function</span> <span class="nx">loadData</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">showLoader</span><span class="p">();</span>

            <span class="nx">$</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="s1">'https://localhost:44313/api/customer'</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">customerList</span><span class="p">,</span> <span class="nx">textStatus</span><span class="p">,</span> <span class="nx">jqXHR</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">CUSTOMER_TABLE_BODY</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">getDataRows</span><span class="p">(</span><span class="nx">customerList</span><span class="p">));</span>
                    <span class="nx">showCustomerRows</span><span class="p">(</span><span class="nx">CUSTOMER_TABLE_BODY</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">CUSTOMER_ROW_SELECTOR</span><span class="p">));</span>
                <span class="p">})</span>
                <span class="p">.</span><span class="nx">fail</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">jqXHR</span><span class="p">,</span> <span class="nx">textStatus</span><span class="p">,</span> <span class="nx">errorThrown</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">alert</span><span class="p">(</span><span class="s1">'error '</span> <span class="o">+</span> <span class="nx">textStatus</span> <span class="o">+</span> <span class="s1">' '</span> <span class="o">+</span> <span class="nx">errorThrown</span><span class="p">);</span>
                <span class="p">});</span>
        <span class="p">}</span>

        <span class="kd">function</span> <span class="nx">getDataRows</span><span class="p">(</span><span class="nx">customerList</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">const</span> <span class="nx">rowTemplate</span> <span class="o">=</span> <span class="s1">'&lt;tr class="customer-row"&gt;&lt;td&gt;{name}&lt;/td&gt;&lt;td&gt;{email}&lt;/td&gt;&lt;td&gt;{country}&lt;/td&gt;&lt;/tr&gt;'</span><span class="p">;</span>
            <span class="kd">let</span> <span class="nx">dataRows</span> <span class="o">=</span> <span class="s1">'&lt;tr class="loading-row"&gt;&lt;td colspan="3"&gt;&lt;progress&gt;&lt;/progress&gt;&lt;/td&gt;&lt;/tr&gt;'</span><span class="p">;</span>

            <span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">customerList</span><span class="p">,</span>
                <span class="kd">function</span> <span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="nx">customer</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">dataRows</span> <span class="o">+=</span> <span class="nx">rowTemplate</span>
                        <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">'{name}'</span><span class="p">,</span> <span class="nx">customer</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span>
                        <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">'{email}'</span><span class="p">,</span> <span class="nx">customer</span><span class="p">.</span><span class="nx">email</span><span class="p">)</span>
                        <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">'{country}'</span><span class="p">,</span> <span class="nx">customer</span><span class="p">.</span><span class="nx">country</span><span class="p">);</span>
                <span class="p">});</span>

            <span class="k">return</span> <span class="nx">dataRows</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="kd">function</span> <span class="nx">showLoader</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">CUSTOMER_TABLE_BODY</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">LOADING_ROW_SELECTOR</span><span class="p">).</span><span class="nx">removeClass</span><span class="p">(</span><span class="nx">DISPLAY_NONE_CLASS</span><span class="p">);</span>

            <span class="kd">const</span> <span class="nx">dataRows</span> <span class="o">=</span> <span class="nx">CUSTOMER_TABLE_BODY</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">CUSTOMER_ROW_SELECTOR</span><span class="p">);</span>
            <span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">dataRows</span><span class="p">,</span>
                <span class="kd">function</span> <span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="nx">row</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">$</span><span class="p">(</span><span class="nx">row</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="nx">DISPLAY_NONE_CLASS</span><span class="p">);</span>
                <span class="p">});</span>
        <span class="p">}</span>

        <span class="kd">function</span> <span class="nx">showCustomerRows</span><span class="p">(</span><span class="nx">customerRows</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">customerRows</span><span class="p">,</span>
                <span class="kd">function</span> <span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="nx">row</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">$</span><span class="p">(</span><span class="nx">row</span><span class="p">).</span><span class="nx">removeClass</span><span class="p">(</span><span class="nx">DISPLAY_NONE_CLASS</span><span class="p">);</span>
                <span class="p">});</span>
            <span class="nx">CUSTOMER_TABLE_BODY</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">LOADING_ROW_SELECTOR</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="nx">DISPLAY_NONE_CLASS</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="kd">function</span> <span class="nx">filterData</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">showLoader</span><span class="p">();</span>

            <span class="kd">const</span> <span class="nx">customerRows</span> <span class="o">=</span> <span class="nx">CUSTOMER_TABLE_BODY</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">CUSTOMER_ROW_SELECTOR</span><span class="p">);</span>
            <span class="kd">const</span> <span class="nx">searchName</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'#searchCustomerName'</span><span class="p">).</span><span class="nx">val</span><span class="p">();</span>
            <span class="kd">const</span> <span class="nx">searchEmail</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'#searchEmail'</span><span class="p">).</span><span class="nx">val</span><span class="p">();</span>
            <span class="kd">const</span> <span class="nx">searchCountry</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'#searchCountry'</span><span class="p">).</span><span class="nx">val</span><span class="p">();</span>

            <span class="kd">const</span> <span class="nx">rowsToShow</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">grep</span><span class="p">(</span><span class="nx">customerRows</span><span class="p">,</span>
                <span class="kd">function</span> <span class="p">(</span><span class="nx">customerRow</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kd">let</span> <span class="nx">columns</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">customerRow</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="s1">'td'</span><span class="p">);</span>

                    <span class="k">return</span> <span class="nx">isMatchForFilter</span><span class="p">(</span><span class="nx">searchName</span><span class="p">,</span> <span class="nx">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">innerHTML</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
                        <span class="nx">isMatchForFilter</span><span class="p">(</span><span class="nx">searchEmail</span><span class="p">,</span> <span class="nx">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">innerHTML</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
                        <span class="nx">isMatchForFilter</span><span class="p">(</span><span class="nx">searchCountry</span><span class="p">,</span> <span class="nx">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nx">innerHTML</span><span class="p">);</span>


                <span class="p">});</span>

           <span class="nx">showCustomerRows</span><span class="p">(</span><span class="nx">rowsToShow</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="kd">function</span> <span class="nx">isMatchForFilter</span><span class="p">(</span><span class="nx">searchValue</span><span class="p">,</span> <span class="nx">valueInRow</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">searchValue</span> <span class="o">===</span> <span class="s1">''</span> <span class="o">||</span>
                <span class="nx">valueInRow</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">searchValue</span><span class="p">)</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="nx">loadData</span><span class="p">();</span>
        <span class="p">});</span>
    <span class="nt">&lt;/script&gt;</span>
}
</code></pre></div></div>

<h2 id="self-executing-functions">Self-executing functions</h2>

<p>An example of a self-executing module is shown below. The proper term for the self-executing module is Immediately Invoked Function Expressions or IIFE.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">$</span><span class="p">,</span> <span class="nx">someOtherInjectedModule</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">CURRENT_MODULE</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="kd">const</span> <span class="nx">PRIVATE_VARIABLE</span> <span class="o">=</span> <span class="s1">'Hello world!'</span><span class="p">;</span>

    <span class="nx">CURRENT_MODULE</span><span class="p">.</span><span class="nx">myPublicFunction</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">privateFunction</span><span class="p">();</span>
    <span class="p">};</span>

    <span class="kd">function</span> <span class="nx">privateFunction</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">alert</span><span class="p">(</span><span class="nx">PRIVATE_VARIABLE</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nb">window</span><span class="p">.</span><span class="nx">ModuleExample</span> <span class="o">=</span> <span class="nx">CURRENT_MODULE</span><span class="p">;</span>

<span class="p">})(</span><span class="nx">jQuery</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">SomeOtherModule</span><span class="p">);</span>

<span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nb">window</span><span class="p">.</span><span class="nx">ModuleExample</span><span class="p">.</span><span class="nx">myPublicFunction</span><span class="p">();</span>
<span class="p">});</span>
</code></pre></div></div>

<p>The function parameters make it possible to inject dependencies. This has 2 benefits.</p>

<ol>
  <li>
    <p>You can inject mocks when unit testing. This makes unit testing much easier.</p>
  </li>
  <li>
    <p>All the external dependencies, that the class relies on, are shown at the top and bottom of the file.</p>
  </li>
</ol>

<p>Another great benefit that this pattern gives is variable scoping. All variables scoped within the module are scoped to the function and do not have to be global.</p>

<p>The CURRENT_MODULE object and all its functions/properties are exposed globally by assigning it to a global window property. All the other “private” functions and variables are never exposed outside the scope of the self-executing function.</p>

<p>The  example as shown in the first code listing of this post rewritten with an IIFE is shown below.</p>

<p>A working Visual Studio project with the code listed below can be found in my <a href="https://github.com/SamanthaNeilen/JavascriptModulesExamples">JavaScriptModuleExamples repository on GitHub</a>.</p>

<p>customer-overview.js:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">$</span><span class="p">,</span> <span class="nx">customerService</span><span class="p">,</span> <span class="nx">utilitiesModule</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">CURRENT_MODULE</span> <span class="o">=</span> <span class="p">{},</span>
        <span class="nx">CUSTOMER_ROW_SELECTOR</span> <span class="o">=</span> <span class="s1">'.customer-row'</span><span class="p">,</span>
        <span class="nx">LOADING_ROW_SELECTOR</span> <span class="o">=</span> <span class="s1">'.loading-row'</span><span class="p">,</span>
        <span class="nx">CUSTOMER_TABLE_BODY</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'#customer-table-body'</span><span class="p">);</span>

    <span class="nx">CURRENT_MODULE</span><span class="p">.</span><span class="nx">initialize</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">$</span><span class="p">(</span><span class="s1">'#customerOverviewSearchButton'</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">'click'</span><span class="p">,</span> <span class="nx">CURRENT_MODULE</span><span class="p">.</span><span class="nx">filterData</span><span class="p">);</span>
        <span class="nx">CURRENT_MODULE</span><span class="p">.</span><span class="nx">loadData</span><span class="p">();</span>
    <span class="p">};</span>

    <span class="nx">CURRENT_MODULE</span><span class="p">.</span><span class="nx">loadData</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nx">showLoader</span><span class="p">();</span>

        <span class="nx">customerService</span><span class="p">.</span><span class="nx">getCustomers</span><span class="p">(</span><span class="nx">showCustomerData</span><span class="p">);</span>
    <span class="p">};</span>

    <span class="nx">CURRENT_MODULE</span><span class="p">.</span><span class="nx">filterData</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nx">showLoader</span><span class="p">();</span>

        <span class="kd">const</span> <span class="nx">customerRows</span> <span class="o">=</span> <span class="nx">CUSTOMER_TABLE_BODY</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">CUSTOMER_ROW_SELECTOR</span><span class="p">);</span>
        <span class="kd">const</span> <span class="nx">searchName</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'#searchCustomerName'</span><span class="p">).</span><span class="nx">val</span><span class="p">();</span>
        <span class="kd">const</span> <span class="nx">searchEmail</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'#searchEmail'</span><span class="p">).</span><span class="nx">val</span><span class="p">();</span>
        <span class="kd">const</span> <span class="nx">searchCountry</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'#searchCountry'</span><span class="p">).</span><span class="nx">val</span><span class="p">();</span>

        <span class="kd">const</span> <span class="nx">rowsToShow</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">grep</span><span class="p">(</span><span class="nx">customerRows</span><span class="p">,</span>
            <span class="kd">function</span> <span class="p">(</span><span class="nx">customerRow</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">const</span> <span class="nx">columns</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">customerRow</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="s1">'td'</span><span class="p">);</span>

                <span class="k">return</span> <span class="nx">utilitiesModule</span><span class="p">.</span><span class="nx">isMatchForFilter</span><span class="p">(</span><span class="nx">searchName</span><span class="p">,</span> <span class="nx">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">innerHTML</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
                    <span class="nx">utilitiesModule</span><span class="p">.</span><span class="nx">isMatchForFilter</span><span class="p">(</span><span class="nx">searchEmail</span><span class="p">,</span> <span class="nx">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">innerHTML</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
                    <span class="nx">utilitiesModule</span><span class="p">.</span><span class="nx">isMatchForFilter</span><span class="p">(</span><span class="nx">searchCountry</span><span class="p">,</span> <span class="nx">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nx">innerHTML</span><span class="p">);</span>
            <span class="p">});</span>

        <span class="nx">showCustomerRows</span><span class="p">(</span><span class="nx">rowsToShow</span><span class="p">);</span>
    <span class="p">};</span>

    <span class="kd">function</span> <span class="nx">showCustomerData</span><span class="p">(</span><span class="nx">customerList</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">CUSTOMER_TABLE_BODY</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">getDataRows</span><span class="p">(</span><span class="nx">customerList</span><span class="p">));</span>
        <span class="nx">showCustomerRows</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">getDataRows</span><span class="p">(</span><span class="nx">customerList</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">outerHtmlProperty</span> <span class="o">=</span> <span class="s1">'outerHTML'</span><span class="p">;</span>
        <span class="kd">const</span> <span class="nx">dataRowTemplateId</span> <span class="o">=</span> <span class="s1">'data-row-template'</span><span class="p">;</span>
        <span class="kd">const</span> <span class="nx">rowTemplate</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'#'</span> <span class="o">+</span> <span class="nx">dataRowTemplateId</span><span class="p">).</span><span class="nx">prop</span><span class="p">(</span><span class="nx">outerHtmlProperty</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">'id="'</span> <span class="o">+</span> <span class="nx">dataRowTemplateId</span> <span class="o">+</span> <span class="s1">'"'</span><span class="p">,</span> <span class="s1">''</span><span class="p">);</span>

        <span class="kd">let</span> <span class="nx">dataRows</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">LOADING_ROW_SELECTOR</span><span class="p">).</span><span class="nx">prop</span><span class="p">(</span><span class="nx">outerHtmlProperty</span><span class="p">);</span>

        <span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">customerList</span><span class="p">,</span>
            <span class="kd">function</span> <span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="nx">customer</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">dataRows</span> <span class="o">+=</span> <span class="nx">rowTemplate</span>
                    <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">'{name}'</span><span class="p">,</span> <span class="nx">customer</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span>
                    <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">'{email}'</span><span class="p">,</span> <span class="nx">customer</span><span class="p">.</span><span class="nx">email</span><span class="p">)</span>
                    <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">'{country}'</span><span class="p">,</span> <span class="nx">customer</span><span class="p">.</span><span class="nx">country</span><span class="p">);</span>
            <span class="p">});</span>

        <span class="k">return</span> <span class="nx">dataRows</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">showLoader</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">utilitiesModule</span><span class="p">.</span><span class="nx">showElement</span><span class="p">(</span><span class="nx">LOADING_ROW_SELECTOR</span><span class="p">,</span> <span class="nx">CUSTOMER_TABLE_BODY</span><span class="p">);</span>

        <span class="nx">forEachCustomerRow</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">row</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">utilitiesModule</span><span class="p">.</span><span class="nx">hideElement</span><span class="p">(</span><span class="nx">row</span><span class="p">,</span> <span class="nx">CUSTOMER_TABLE_BODY</span><span class="p">);</span>
        <span class="p">});</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">showCustomerRows</span><span class="p">(</span><span class="nx">filteredRows</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">forEachCustomerRow</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">row</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">utilitiesModule</span><span class="p">.</span><span class="nx">showElement</span><span class="p">(</span><span class="nx">row</span><span class="p">,</span> <span class="nx">CUSTOMER_TABLE_BODY</span><span class="p">);</span>
        <span class="p">},</span> <span class="nx">filteredRows</span><span class="p">);</span>

        <span class="nx">utilitiesModule</span><span class="p">.</span><span class="nx">hideElement</span><span class="p">(</span><span class="nx">LOADING_ROW_SELECTOR</span><span class="p">,</span> <span class="nx">CUSTOMER_TABLE_BODY</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">forEachCustomerRow</span><span class="p">(</span><span class="nx">callBack</span><span class="p">,</span> <span class="nx">filteredRows</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">customerRows</span> <span class="o">=</span> <span class="nx">CUSTOMER_TABLE_BODY</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">CUSTOMER_ROW_SELECTOR</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">filteredRows</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">customerRows</span> <span class="o">=</span> <span class="nx">filteredRows</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">customerRows</span><span class="p">,</span>
            <span class="kd">function</span> <span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="nx">row</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">callBack</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">row</span><span class="p">));</span>
            <span class="p">});</span>
    <span class="p">}</span>

    <span class="nb">window</span><span class="p">.</span><span class="nx">customerOverviewModule</span> <span class="o">=</span> <span class="nx">CURRENT_MODULE</span><span class="p">;</span>

<span class="p">})(</span><span class="nx">jQuery</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">customerService</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">utilitiesModule</span><span class="p">);</span>

<span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nb">window</span><span class="p">.</span><span class="nx">customerOverviewModule</span><span class="p">.</span><span class="nx">initialize</span><span class="p">();</span>
<span class="p">});</span>
</code></pre></div></div>
<p>utilities.js</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">$</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">CURRENT_MODULE</span> <span class="o">=</span> <span class="p">{},</span>
        <span class="nx">DISPLAY_NONE_CLASS</span> <span class="o">=</span> <span class="s1">'display-none'</span><span class="p">;</span>

    <span class="nx">CURRENT_MODULE</span><span class="p">.</span><span class="nx">isMatchForFilter</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">searchValue</span><span class="p">,</span> <span class="nx">valueInRow</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">searchValue</span> <span class="o">===</span> <span class="s1">''</span> <span class="o">||</span>
            <span class="nx">valueInRow</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">searchValue</span><span class="p">)</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="nx">CURRENT_MODULE</span><span class="p">.</span><span class="nx">hideElement</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">elementSelector</span><span class="p">,</span> <span class="nx">parentSelector</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">parent</span> <span class="o">=</span> <span class="nx">getParent</span><span class="p">(</span><span class="nx">parentSelector</span><span class="p">);</span>
        <span class="nx">parent</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">elementSelector</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="nx">DISPLAY_NONE_CLASS</span><span class="p">);</span>
    <span class="p">};</span>

    <span class="nx">CURRENT_MODULE</span><span class="p">.</span><span class="nx">showElement</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">elementSelector</span><span class="p">,</span> <span class="nx">parentSelector</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">parent</span> <span class="o">=</span> <span class="nx">getParent</span><span class="p">(</span><span class="nx">parentSelector</span><span class="p">);</span>
        <span class="nx">parent</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">elementSelector</span><span class="p">).</span><span class="nx">removeClass</span><span class="p">(</span><span class="nx">DISPLAY_NONE_CLASS</span><span class="p">);</span>
    <span class="p">};</span>

    <span class="kd">function</span> <span class="nx">getParent</span><span class="p">(</span><span class="nx">parentSelector</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">parent</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">parentSelector</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">parent</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">parentSelector</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nx">parent</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nb">window</span><span class="p">.</span><span class="nx">utilitiesModule</span> <span class="o">=</span> <span class="nx">CURRENT_MODULE</span><span class="p">;</span>
<span class="p">})(</span><span class="nx">jQuery</span><span class="p">);</span>
</code></pre></div></div>
<p>customer-service.js</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">$</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">CURRENT_MODULE</span> <span class="o">=</span> <span class="p">{},</span>
        <span class="nx">CUSTOMER_URI</span> <span class="o">=</span> <span class="s1">'https://localhost:44313/api/customer'</span><span class="p">;</span>

    <span class="nx">CURRENT_MODULE</span><span class="p">.</span><span class="nx">getCustomers</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">successCallBack</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">$</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">CUSTOMER_URI</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">customerList</span><span class="p">,</span> <span class="nx">textStatus</span><span class="p">,</span> <span class="nx">jqXHR</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">successCallBack</span><span class="p">(</span><span class="nx">customerList</span><span class="p">);</span>
            <span class="p">})</span>
            <span class="p">.</span><span class="nx">fail</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">jqXHR</span><span class="p">,</span> <span class="nx">textStatus</span><span class="p">,</span> <span class="nx">errorThrown</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">alert</span><span class="p">(</span><span class="s1">'error '</span> <span class="o">+</span> <span class="nx">textStatus</span> <span class="o">+</span> <span class="s1">' '</span> <span class="o">+</span> <span class="nx">errorThrown</span><span class="p">);</span>
            <span class="p">});</span>
    <span class="p">};</span>
  
    <span class="nb">window</span><span class="p">.</span><span class="nx">customerService</span> <span class="o">=</span> <span class="nx">CURRENT_MODULE</span><span class="p">;</span>
<span class="p">})(</span><span class="nx">jQuery</span><span class="p">);</span>
</code></pre></div></div>

<p>index.cshtml:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@page
@model IndexModel
@{
    ViewData["Title"] = "Home page";
}
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;h1&gt;</span>Customer overview<span class="nt">&lt;/h1&gt;</span>

    @* Searchform *@
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"search-customer"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group row"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"searchCustomerName"</span> <span class="na">class=</span><span class="s">"col-sm-2 col-form-label"</span><span class="nt">&gt;</span>@Texts.Name<span class="nt">&lt;/label&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-sm-5"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">id=</span><span class="s">"searchCustomerName"</span> <span class="na">value=</span><span class="s">""</span><span class="nt">&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group row"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"searchEmail"</span> <span class="na">class=</span><span class="s">"col-sm-2 col-form-label"</span><span class="nt">&gt;</span>@Texts.Email<span class="nt">&lt;/label&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-sm-5"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">id=</span><span class="s">"searchEmail"</span> <span class="na">value=</span><span class="s">""</span><span class="nt">&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group row"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"searchCountry"</span> <span class="na">class=</span><span class="s">"col-sm-2 col-form-label"</span><span class="nt">&gt;</span>@Texts.Country<span class="nt">&lt;/label&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-sm-5"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">id=</span><span class="s">"searchCountry"</span> <span class="na">value=</span><span class="s">""</span><span class="nt">&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;button</span> <span class="na">id=</span><span class="s">"customerOverviewSearchButton"</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">class=</span><span class="s">"btn btn-sm btn-primary col-sm-2"</span><span class="nt">&gt;</span>@Texts.Search<span class="nt">&lt;/button&gt;</span>
    <span class="nt">&lt;/div&gt;</span>

    @* Grid for data *@
    <span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">"table mt-2"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;thead&gt;</span>
            <span class="nt">&lt;tr&gt;</span>
                <span class="nt">&lt;th</span> <span class="na">scope=</span><span class="s">"col"</span><span class="nt">&gt;</span>@Texts.Name<span class="nt">&lt;/th&gt;</span>
                <span class="nt">&lt;th</span> <span class="na">scope=</span><span class="s">"col"</span><span class="nt">&gt;</span>@Texts.Email<span class="nt">&lt;/th&gt;</span>
                <span class="nt">&lt;th</span> <span class="na">scope=</span><span class="s">"col"</span><span class="nt">&gt;</span>@Texts.Country<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;/tr&gt;</span>
        <span class="nt">&lt;/thead&gt;</span>
        <span class="nt">&lt;tbody</span> <span class="na">id=</span><span class="s">"customer-table-body"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;tr</span> <span class="na">class=</span><span class="s">"loading-row"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;td</span> <span class="na">colspan=</span><span class="s">"3"</span><span class="nt">&gt;&lt;progress&gt;&lt;/progress&gt;&lt;/td&gt;</span>
            <span class="nt">&lt;/tr&gt;</span>
        <span class="nt">&lt;/tbody&gt;</span>
    <span class="nt">&lt;/table&gt;</span>

    @* Row templates *@
    <span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">"display-none"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;tr</span> <span class="na">id=</span><span class="s">"data-row-template"</span> <span class="na">class=</span><span class="s">"customer-row"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;td&gt;</span>{name}<span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;td&gt;</span>{email}<span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;td&gt;</span>{country}<span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;/tr&gt;</span>
    <span class="nt">&lt;/table&gt;</span>
<span class="nt">&lt;/div&gt;</span>

@section Scripts {
    <span class="nt">&lt;environment</span> <span class="na">include=</span><span class="s">"Development"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"~/js/utilities.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
        <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"~/js/customer-service.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
        <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"~/js/customer-overview.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;/environment&gt;</span>
    <span class="nt">&lt;environment</span> <span class="na">exclude=</span><span class="s">"Development"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"~/js/dist/customer-overview.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;/environment&gt;</span>
}
</code></pre></div></div>
<p>bundleconfig.json (to generate the minified file in de dist folder)</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"outputFileName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"wwwroot/css/site.min.css"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"inputFiles"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"wwwroot/css/site.css"</span><span class="w"> </span><span class="p">]</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"outputFileName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"wwwroot/js/dist/customer-overview.min.js"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"inputFiles"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"wwwroot/js/utilities.js"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"wwwroot/js/customer-service.js"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"wwwroot/js/customer-overview.js"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"minify"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"enabled"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"renameLocals"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"sourceMap"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>
<h2 id="separating-html-control-events-and-javascript-hook-ups">Separating HTML control events and JavaScript hook-ups</h2>

<p>When embedding JavaScript in the HTML pages, the event hookups are usually written directly in the controls, mixing markup with the JavaScript. In my opinion, this makes it harder to find how and where my JavaScript functions are used.</p>

<p>By hooking up al the events in the JavaScript module there’s no need to embed any JavaScript in the markup for the page. The HTML markup is only used for layout. The functionality and/or interaction logic is completely separate and centralized in the JavaScript modules.</p>

<p>There are still dependencies between the DOM and the JavaScript module but the test framework I have been using (Jest) provides a DOM mock. The DOM mock can be accessed like the browser DOM and you can test the interactions and their results. I’ll show examples in my next blog post.</p>

<p>The example page with embedded JavaScript, rewritten with an IIFE is shown below.</p>

<p>Event hookup before (in the html):</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">class=</span><span class="s">"btn btn-sm btn-primary col-sm-2"</span> <span class="na">onclick=</span><span class="s">"window.customerOverviewModule.filterData()"</span><span class="nt">&gt;</span>@Texts.Search<span class="nt">&lt;/button&gt;</span>
</code></pre></div></div>

<p>Event hookup after refactoring to the IIFE:</p>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;button</span> <span class="na">id=</span><span class="s">"customerOverviewSearchButton"</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">class=</span><span class="s">"btn btn-sm btn-primary col-sm-2"</span><span class="nt">&gt;</span>@Texts.Search<span class="nt">&lt;/button&gt;</span>
</code></pre></div></div>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">$</span><span class="p">,</span> <span class="nx">customerService</span><span class="p">,</span> <span class="nx">utilitiesModule</span><span class="p">)</span> <span class="p">{</span>

     <span class="c1">///...</span>
    
     <span class="nx">CURRENT_MODULE</span><span class="p">.</span><span class="nx">initialize</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">$</span><span class="p">(</span><span class="s1">'#customerOverviewSearchButton'</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">'click'</span><span class="p">,</span> <span class="nx">CURRENT_MODULE</span><span class="p">.</span><span class="nx">filterData</span><span class="p">);</span>
        
        <span class="nx">CURRENT_MODULE</span><span class="p">.</span><span class="nx">loadData</span><span class="p">();</span>
    <span class="p">};</span>

     <span class="nx">CURRENT_MODULE</span><span class="p">.</span><span class="nx">loadData</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
         <span class="c1">///...</span>
     <span class="p">};</span>
    
     <span class="nx">CURRENT_MODULE</span><span class="p">.</span><span class="nx">filterData</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
     	<span class="c1">///...</span>
     <span class="p">};</span>
     
     <span class="c1">///...</span>
     
     <span class="nb">window</span><span class="p">.</span><span class="nx">customerOverviewModule</span> <span class="o">=</span> <span class="nx">CURRENT_MODULE</span><span class="p">;</span>

<span class="p">})(</span><span class="nx">jQuery</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">customerService</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">utilitiesModule</span><span class="p">);</span>

<span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nb">window</span><span class="p">.</span><span class="nx">customerOverviewModule</span><span class="p">.</span><span class="nx">initialize</span><span class="p">();</span>
<span class="p">});</span>
</code></pre></div></div>
<h2 id="separating-html-templating-from-your-javascript-code">Separating HTML templating from your JavaScript code</h2>

<p>Sometimes you have to create multiple repeating element groups from a JavaScript array. An example is calling an API to retrieve orders then printing a line with each order object. You might define a constant with the HTML template as a string in your JavaScript. For maintainability, code completion and analysis benefits, I find it better to just include a hidden div with the template on the page. You won’t have to deal with escaping reserved characters in a string like quotes and slashes and also gain indenting and linting support from your IDE.</p>

<p>The HTML string used before the refactoring was:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">function</span> <span class="nx">getDataRows</span><span class="p">(</span><span class="nx">customerList</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">const</span> <span class="nx">rowTemplate</span> <span class="o">=</span> <span class="s1">'&lt;tr class="customer-row"&gt;&lt;td&gt;{name}&lt;/td&gt;&lt;td&gt;{email}&lt;/td&gt;&lt;td&gt;{country}&lt;/td&gt;&lt;/tr&gt;'</span><span class="p">;</span>
            <span class="kd">let</span> <span class="nx">dataRows</span> <span class="o">=</span> <span class="s1">'&lt;tr class="loading-row"&gt;&lt;td colspan="3"&gt;&lt;progress&gt;&lt;/progress&gt;&lt;/td&gt;&lt;/tr&gt;'</span><span class="p">;</span>

            <span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">customerList</span><span class="p">,</span>
                <span class="kd">function</span> <span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="nx">customer</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">dataRows</span> <span class="o">+=</span> <span class="nx">rowTemplate</span>
                        <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">'{name}'</span><span class="p">,</span> <span class="nx">customer</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span>
                        <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">'{email}'</span><span class="p">,</span> <span class="nx">customer</span><span class="p">.</span><span class="nx">email</span><span class="p">)</span>
                        <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">'{country}'</span><span class="p">,</span> <span class="nx">customer</span><span class="p">.</span><span class="nx">country</span><span class="p">);</span>
                <span class="p">});</span>

            <span class="k">return</span> <span class="nx">dataRows</span><span class="p">;</span>
        <span class="p">}</span>
</code></pre></div></div>
<p>The code using templating from the overview page example as an IIFE  is shown below:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code> @* Grid for data *@
    <span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">"table mt-2"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;thead&gt;</span>
            <span class="nt">&lt;tr&gt;</span>
                <span class="nt">&lt;th</span> <span class="na">scope=</span><span class="s">"col"</span><span class="nt">&gt;</span>@Texts.Name<span class="nt">&lt;/th&gt;</span>
                <span class="nt">&lt;th</span> <span class="na">scope=</span><span class="s">"col"</span><span class="nt">&gt;</span>@Texts.Email<span class="nt">&lt;/th&gt;</span>
                <span class="nt">&lt;th</span> <span class="na">scope=</span><span class="s">"col"</span><span class="nt">&gt;</span>@Texts.Country<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;/tr&gt;</span>
        <span class="nt">&lt;/thead&gt;</span>
        <span class="nt">&lt;tbody</span> <span class="na">id=</span><span class="s">"customer-table-body"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;tr</span> <span class="na">class=</span><span class="s">"loading-row"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;td</span> <span class="na">colspan=</span><span class="s">"3"</span><span class="nt">&gt;&lt;progress&gt;&lt;/progress&gt;&lt;/td&gt;</span>
            <span class="nt">&lt;/tr&gt;</span>
        <span class="nt">&lt;/tbody&gt;</span>
    <span class="nt">&lt;/table&gt;</span>

    @* Row templates *@
    <span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">"display-none"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;tr</span> <span class="na">id=</span><span class="s">"data-row-template"</span> <span class="na">class=</span><span class="s">"customer-row"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;td&gt;</span>{name}<span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;td&gt;</span>{email}<span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;td&gt;</span>{country}<span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;/tr&gt;</span>
    <span class="nt">&lt;/table&gt;</span>
</code></pre></div></div>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="kd">function</span> <span class="nx">getDataRows</span><span class="p">(</span><span class="nx">customerList</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">outerHtmlProperty</span> <span class="o">=</span> <span class="s1">'outerHTML'</span><span class="p">;</span>
        <span class="kd">const</span> <span class="nx">dataRowTemplateId</span> <span class="o">=</span> <span class="s1">'data-row-template'</span><span class="p">;</span>
        <span class="kd">const</span> <span class="nx">rowTemplate</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'#'</span> <span class="o">+</span> <span class="nx">dataRowTemplateId</span><span class="p">).</span><span class="nx">prop</span><span class="p">(</span><span class="nx">outerHtmlProperty</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">'id="'</span> <span class="o">+</span> <span class="nx">dataRowTemplateId</span> <span class="o">+</span> <span class="s1">'"'</span><span class="p">,</span> <span class="s1">''</span><span class="p">);</span>

        <span class="kd">let</span> <span class="nx">dataRows</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">LOADING_ROW_SELECTOR</span><span class="p">).</span><span class="nx">prop</span><span class="p">(</span><span class="nx">outerHtmlProperty</span><span class="p">);</span>

        <span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">customerList</span><span class="p">,</span>
            <span class="kd">function</span> <span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="nx">customer</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">dataRows</span> <span class="o">+=</span> <span class="nx">rowTemplate</span>
                    <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">'{name}'</span><span class="p">,</span> <span class="nx">customer</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span>
                    <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">'{email}'</span><span class="p">,</span> <span class="nx">customer</span><span class="p">.</span><span class="nx">email</span><span class="p">)</span>
                    <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">'{country}'</span><span class="p">,</span> <span class="nx">customer</span><span class="p">.</span><span class="nx">country</span><span class="p">);</span>
            <span class="p">});</span>

        <span class="k">return</span> <span class="nx">dataRows</span><span class="p">;</span>
    <span class="p">}</span>
</code></pre></div></div>

    </div>
    
</article>

                </main>
            </div>
            <div class="col-md-3">
                <aside aria-label="sidebar">
                    <section class="sidebar-section">
    <h3>About me</h3>
    I am a dutch .NET developer.
    I have been coding professionally since 2008.
    On this blog, I will be writing about multiple subjects that I use in my daily programming job or subjects that I am studying.
</section>
<section class="sidebar-section">
    <h3>Social</h3>
    <a href="https://github.com/SamanthaNeilen"><i class="fa fa-github" aria-hidden="true"></i><span>&nbsp;SamanthaNeilen</span></a> <br />
    <a href="https://twitter.com/NeilenSamantha"><i class="fa fa-twitter" aria-hidden="true"></i><span>&nbsp;NeilenSamantha</span></a> <br />
    <a href="https://www.linkedin.com/in/samantha-neilen-16153713"><i class="fa fa-linkedin" aria-hidden="true"></i><span>&nbsp;Samantha Neilen</span></a><br />
    Subscribe via <a href="/feed.xml">RSS</a>
</section>
<section class="sidebar-section">
    <h3>Last posts </h3>
    
    <a href="/2020/06/29/Using-Postman-for-quick-and-repeatable-API-tests.html">Using Postman for quick and repeatable API tests</a> <br />
    <div class="last-posts-spacer"></div>
    
    <a href="/2020/05/04/Calling-async-methods-with-configureawait.html">Calling async methods with ConfigureAwait</a> <br />
    <div class="last-posts-spacer"></div>
    
    <a href="/2020/03/18/Tips-for-building-habits-around-working-from-home.html">Tips for building habits around working from home</a> <br />
    <div class="last-posts-spacer"></div>
    
    <a href="/2020/02/08/Unit-testing-self-executing-JavaScript-Modules-in-Visual-Studio.html">Unit testing self-executing JavaScript modules in Visual Studio</a> <br />
    <div class="last-posts-spacer"></div>
    
    <a href="/2019/12/30/Creating-more-maintainable-javascript-with-self-executing-functions.html">Creating more maintainable JavaScript with self-executing functions</a> <br />
    <div class="last-posts-spacer"></div>
    
    <a href="/archive">Archive</a>
</section>
                </aside>
            </div>
        </div>
    </div>
</body>
</html>
